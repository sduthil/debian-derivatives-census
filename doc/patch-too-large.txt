This patch was too large (> 5MiB) to be useful so it was removed.
