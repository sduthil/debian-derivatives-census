#!/bin/sh

# Copyright 2011 Paul Wise
# Released under the MIT/Expat license, see doc/COPYING

# Downloads the apt metadata using apt-get and a sources.list
#
# Usage:
# get-package-lists <sources.list> <apt dir>

set -e
test -f "$1" || exit 0
apt="$(readlink -m "$2")"
apt-get update -q=2 -y \
	-o Acquire::http::User-Agent="Debian Derivatives Census QA bot" \
	-o Dir="$apt" \
	-o Dir::Etc="$apt" \
	-o Dir::State="$apt" \
	-o Dir::Cache="$apt" \
	-o Dir::State::status="$apt/status" \
	-o Dir::Etc::sourcelist="$(readlink -m "$1")" \
	-o Dir::Bin::gpg=fakegpgv
